[LINUX KERNEL COMPILE]

# Pobranie kernela i PGP
wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.x.x.tar.xz
wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.x.x.tar.sign

# Kernel - rozpakowanie (xz)
unxz -v linux-5.x.x.tar.xz

# Weryfikacja PGP
 gpg --verify linux-5.x.x.tar.sign
 gpg --recv-keys 79BE3E4300411886
 
# Kernel - rozpakowywanie
tar xvf linux-5.x.x.tar (tar)

# Konfiguracja kernela
cd linux-5.x.x
cp -v /boot/config-$(uname -r) .config

# Instalacja potrzebnych paczek do kompilacji
apt install build-essential libncurses-dev bison flex libssl-dev libelf-dev

# Konfiguracja kernela
make menuconfig

# Kompilacja z wykorzystaniem procesorów
make -j $(nproc)

# Instalacja modułów kernela
make modules_install

# Instalacja kernela
make install

# Aktualizacja grub
update-initramfs -c -k 5.x.x
update-grub
reboot

# Weryfikacja wersji

uname -mrs

# Czyszczenie ze starych wersji kernela
dpkg --list | grep linux-image | awk '{ print $2 }' | sort -V | sed -n '/'`uname -r`'/q;p' | xargs sudo apt-get -y purge

dpkg –list lista pakietów w systemie
grep linux-image pokaż wyłącznie obrazy Linux czyli Kernele
awk ‘{ print $2 }’ Pokazuj wyłącznie drugą kolumne (numer kernela)
sort -V sortuj wyłącznie po wersji
sed -n ‘/’`uname -r`’/q;p’ wyświetl wyłącznie linie poza używanym kernelem
xargs sudo apt-get -y purge usuń stare kernele
